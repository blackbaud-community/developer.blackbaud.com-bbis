<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: DonationService</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: DonationService</h1>

    



<section>

<header>
    <h2>
    DonationService
    </h2>
    
        <div class="class-description">BLACKBAUD.api.DonationService provides methods needed for taking donations and retrieving confirmation information.</div>
    
</header>

<article>
    <div class="container-overview">
    

    
        
<dt>
    <h4 class="name" id="DonationService"><span class="type-signature"></span>new DonationService<span class="signature">(partId, options)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>partId</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>


            

            

            <td class="description last">The Id of an Advanced Donation Form part that will be used as a context for all method calls.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An object literal containing one or more of the following optional properties:
<ul>
<li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved.  This value is optional when accessed from a BBIS page.  The default value will be the BBIS URL of the current page.</li>
<li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page.  When True, the class will handle the complexities of making cross domain requests to retrieve data.  The default value is False.</li>
</ul></td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line76">line 76</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    

    
</dd>

    
    </div>

    

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id="completeBBSPDonation"><span class="type-signature"></span>completeBBSPDonation<span class="signature">(id, successCallback, failureCallback)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Signals the application to confirm that the credit card donation has been paid in Blackbaud secured
payment and to complete the creation of the donation. Updates the donation status and sends the acknowledgment email.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The GUID id of the donation that should be completed.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>successCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request succeeds. The
function will be passed an object describing the donation with the specified Id after its status
has been updated.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>failureCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request fails.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line160">line 160</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    

    
</dd>


<dt>
    <h4 class="name" id="getRecurringGiftInstallmentAmount"><span class="type-signature"></span>getRecurringGiftInstallmentAmount<span class="signature">(totalGiftAmount, numberOfInstallments)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        This calculates the price of each installment for a recurring gift based on the number of installments the website user wants to make.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>totalGiftAmount</code></td>
            

            <td class="type">
            
                
<span class="param-type">Decimal</span>


            
            </td>

            

            

            <td class="description last">The total amount to be donated.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>numberOfInstallments</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">The total number of installments.</td>
        </tr>
    </tbody>
</table>
<dl class="details">
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line113">line 113</a>
    </li></ul></dd>   
</dl>
</dd>


<dt>
    <h4 class="name" id="getRecurringGiftLastPaymentDate"><span class="type-signature"></span>getRecurringGiftLastPaymentDate<span class="signature">(numberOfInstallments,
	frequencyCode, installmentStartDate, installmentMonth, installmentDayOfMonth)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        This calculates the end date of a recurring installment based on the number of installments the website user wants to make.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
            <tr>
            
                <td class="name"><code>numberOfInstallments</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">The total number of installments</td>
        </tr>

        <tr>
            
                <td class="name"><code>frequencyCode</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Frequency code.</td>
        </tr>
		 <tr>
            
                <td class="name"><code>installmentStartDate</code></td>
            

            <td class="type">
            
                
<span class="param-type">date</span>


            
            </td>

            

            

            <td class="description last">Date on which website user wants to start the installment.</td>
        </tr>
 <tr>
            
                <td class="name"><code>installmentMonth</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Installment month.</td>
        </tr>
    
<tr>
            
                <td class="name"><code>installmentDayofMonth</code></td>
            

            <td class="type">
            
                
<span class="param-type">Integer</span>


            
            </td>

            

            

            <td class="description last">Day of the Month.</td>
        </tr>

    </tbody>
</table>
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line113">line 113</a>
    </li></ul></dd>
    

    

    

    
</dl>
</dd>






        
            
<dt>
    <h4 class="name" id="createDonation"><span class="type-signature"></span>createDonation<span class="signature">(donation, successCallback, failureCallback)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Validates the specified donation parameter. If valid, creates a donation transaction
and saves it to the database. Stores the Id of the new donation in session so the user
has permissions for the donation transaction. If the payment type is credit card, 
communicates with Blackbaud secured payment to set up a check out URI and adds that
URI to the return object. For credit card payment, the donation is saved in a Pending
state. For payments not using a credit card, the donation is saved in a Completed state
and an acknowledgement email is sent.
For credit card payments, the page is redirected to the Blackbaud secured payment checkout
page after calling the successCallback function.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>donation</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">An object describing the donation transaction to be created.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>successCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request succeeds. The
function will be passed an object describing the donation that was created.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>failureCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request fails.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line113">line 113</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    

    
</dd>

        
            
<dt>
    <h4 class="name" id="getDonation"><span class="type-signature"></span>getDonation<span class="signature">(id, successCallback, failureCallback)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Ensures the user has access to this donation by finding the Id in their session.
If so, returns information about the donation
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The GUID id of the donation whose information should be returned.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>successCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request succeeds. The
function will be passed an object describing the donation with the specified Id.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>failureCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request fails.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line143">line 143</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    

    
</dd>

        
            
<dt>
    <h4 class="name" id="getDonationConfirmationHtml"><span class="type-signature"></span>getDonationConfirmationHtml<span class="signature">(id, successCallback, failureCallback)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Gets HTML for a confirmation screen for the completed donation. Ensures the user has access to this
donation by finding the Id in their session. If so, loads the donation and merges the fields
into the part’s confirmation block
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The GUID id of the donation that should be completed.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>successCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request succeeds. The
function will be passed a string containing the confirmation HTML from the part with details
from the specified donation merged in.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>failureCallback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function to call if the request fails.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="DonationService.js.html">DonationService.js</a>, <a href="DonationService.js.html#line178">line 178</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    

    
</dd>

        </dl>
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="BLACKBAUD.api.CodeTableService.html">CodeTableService</a></li><li><a href="BLACKBAUD.api.ConsentService.html">ConsentService</a></li><li><a href="BLACKBAUD.api.CountryService.html">CountryService</a></li><li><a href="BLACKBAUD.api.DonationService.html">DonationService</a></li><li><a href="BLACKBAUD.api.ImageService.html">ImageService</a></li><li><a href="BLACKBAUD.api.QueryService.html">QueryService</a></li><li><a href="BLACKBAUD.api.UserService.html">UserService</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Wed Oct 15 2014 10:22:35 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>