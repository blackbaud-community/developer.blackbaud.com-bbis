<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Blackbaud Internet Solutions | Technical Reference | JavaScript</title> <link rel="icon" href="/bbis/assets/img/favicon.ico" type="image/ico"> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> <link rel="stylesheet" href="/bbis/assets/css/combine.site.css?v=2018-11-01-18:16:41"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-2418840-40', 'auto'); ga('send', 'pageview'); </script> </head> <body class="layout-compress section-reference subsection-javascript"> <nav class="navbar" role="navigation" id="top"> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bb-navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a href="/bbis/" class="navbar-brand"> <img src="/bbis/assets/img/logo-bbis.png" alt="Blackbaud Internet Solutions" class="img-responsive" /> </a> </div> <!-- navbar-header --> <div class="collapse navbar-collapse" id="bb-navbar"> <ul class="nav navbar-nav navbar-right"> <li > <a href="/bbis/start/"> Getting Started </a> </li> <li > <a href="/bbis/guide/"> Developer Guide </a> </li> <li class="active"> <a href="/bbis/reference/"> Technical Reference </a> </li> <li class=""> <a href="/bbis/code/"> Code Samples </a> </li> <li > <a href="/bbis/help/"> <i class="fa fa-fw fa-question-circle hidden-xs"></i> <span class="visible-xs-inline">Help</span> </a> </li> </ul> </div> <!-- .navbar-collapse --> </div> <!-- .container --> </nav> <!-- .navbar.navbar-inverse --> <div class="content"> <div class="container"> <div class="row"> <div class="col-md-3 hidden-xs hidden-sm"> <div class="sidebar"> <ul class="nav nav-stacked nav-sidebar scrollspy-start"> <!-- Ridiculous Bootstrap Scrollspy bug that required this nested linkage to function properly --> <li class="hidden"> <a href="#top">Top</a> <ul class="nav"> <li> <a href="#top">Top</a> </li> </ul> </li> <li class="back-to back-to-section"> <a href="/bbis/reference/"> Technical Reference </a> </li> <li> <a href="#codetableservice">Code Table Service</a> <ul class="nav"> <li> <a href="#codetableservice-constructor">new CodeTableService</a> </li> <li> <a href="#codetableservice-getentries">getEntries</a> </li> </ul> </li> <li> <a href="#consentservice">Consent Service</a> <ul class="nav"> <li> <a href="#consentservice-constructor">new ConsentService</a> </li> <li> <a href="#consentservice-getconsentoptions">getConsentOptions</a> </li> </ul> </li> <li> <a href="#countryservice">Country and State Service</a> <ul class="nav"> <li> <a href="#countryservice-constructor">new CountryService</a> </li> <li> <a href="#countryservice-getaddresscaptions">getAddressCaptions</a> </li> <li> <a href="#countryservice-getcountries">getCountries</a> </li> <li> <a href="#countryservice-getstates">getStates</a> </li> </ul> </li> <li> <a href="#donationservice">Donation Service</a> <ul class="nav"> <li> <a href="#donationservice-constructor">new DonationService</a> </li> <li> <a href="#donationservice-completebbspdonation">completeBBSPDonation</a> </li> <li> <a href="#donationservice-getrecurringgiftinstallmentamount">getRecurringGiftInstallmentAmount</a> </li> <li> <a href="#donationservice-getrecurringgiftlastpaymentdate">getRecurringGiftLastPaymentDate</a> </li> <li> <a href="#donationservice-createdonation">createDonation</a> </li> <li> <a href="#donationservice-getdonation">getDonation</a> </li> <li> <a href="#donationservice-getdonationconfirmationhtml">getDonationConfirmationHtml</a> </li> </ul> </li> <li> <a href="#imageservice">Image Service</a> <ul class="nav"> <li> <a href="#imageservice-constructor">new ImageService</a> </li> <li> <a href="#imageservice-getimagesbyfolder">getImagesByFolder</a> </li> <li> <a href="#imageservice-getimagesbyfolderguid">getImagesByFolderGUID</a> </li> <li> <a href="#imageservice-getimagesbytag">getImagesByTag</a> </li> </ul> </li> <li> <a href="#queryservice">Query Service</a> <ul class="nav"> <li> <a href="#queryservice-constructor">new QueryService</a> </li> <li> <a href="#queryservice-getresults">getResults</a> </li> </ul> </li> <li> <a href="#userservice">User Service</a> <ul class="nav"> <li> <a href="#userservice-constructor">new UserService</a> </li> <li> <a href="#userservice-getprofile">getProfile</a> </li> </ul> </li> <li class="back-to back-to-top"> <a href="#top" class=""> <i class="fa fa-caret-square-o-up"></i> </a> </li> </ul> </div> </div> <!-- .col-md-3 --> <div class="col-md-9 readability"> <h1>JavaScript SDK</h1> <p>The JavaScript SDK is a light-weight wrapper library for the <a href="/bbis/reference/rest/">REST API</a>.</p> ï»¿<div id="codetableservice"> <h2 id="codetableservice-constructor">new CodeTableService(options) <a href="#codetableservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.CodeTableService provides methods for retrieving code table entries from the CRM using calls to the BBIS REST services.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="codetableservice-getentries">getEntries(successCallback, failureCallback) <a href="#codetableservice-getentries"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns the active code table entries for the specified code table Id ordered as configured in the CRM.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Id</tt> : The Id of a code table entry.</li> <li><tt>Description</tt> : The description of a code table entry.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> <div id="consentservice"> <h2 id="consentservice-constructor">new ConsentService(options) <a href="#consentservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.ConsentOptionService provides methods for getting consent options from the CRM using calls to the BBIS REST services.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last"> An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul> </td> </tr> </tbody> </table></dd> </dl> <h2 id="consentservice-getconsentoptions">getConsentOptions(consentPartId, successCallback, failureCallback) <a href="#consentservice-getconsentoptions"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns the object of the consent with consent options associated with a specified consent partId.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">consentPartId</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">The Id of a consent part whose consent options should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last"> The function to call if the request succeeds. The function will be passed an object with the following properties: <ul> <li><tt>ConsentPartId</tt> : The id of the consent part.</li> <li><tt>Title</tt> : The title of the consent part.</li> <li><tt>ConsentStatement</tt> : The consentstatement of the consent part.</li> <li><tt>PrivacyPolicy</tt> : The privacypolicy that is set in the consent part.</li> <li><tt>SolicitCodes</tt> : Array of consent options configured in consent part.</li> <li><tt>PrivacyPolicyText</tt> : The privacypolicytext that is set in the consent part.</li> <li><tt>hdnCRMConsentSolicitCode</tt> : The consent solicit code that is selected under web in configure integration of CRM.</li> <li><tt>hdnCRMSolicitCode</tt> : The solicit code that is selected under web in configure integration of CRM.</li> </ul> </td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> <div id="countryservice"> <h2 id="countryservice-constructor">new CountryService(options) <a href="#countryservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.CountryService provides methods for getting state and country information from the CRM using calls to the BBIS REST services.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="countryservice-getaddresscaptions">getAddressCaptions(countryId, successCallback, failureCallback) <a href="#countryservice-getaddresscaptions"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns the internationalized address captions associated with a specified country.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">countryId</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The Id of a country whose address captions should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object with the following properties: <ul> <li><tt>AddressLines</tt> : The caption for the address lines.</li> <li><tt>City</tt> : The caption for the city.</li> <li><tt>State</tt> : The caption for the state.</li> <li><tt>PostCode</tt> : The caption for the postal code.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="countryservice-getcountries">getCountries(successCallback, failureCallback) <a href="#countryservice-getcountries"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns a list of all active countries alphabetized by their description.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Id</tt> : The Id of a country.</li> <li><tt>Abbreviation</tt> : The abbreviation of a country.</li> <li><tt>Description</tt> : The description of a country.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="countryservice-getstates">getStates(countryId, successCallback, failureCallback) <a href="#countryservice-getstates"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns a list of states associated with a specified country, alphabetized by their description.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">countryId</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The Id of a country whose states should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Id</tt> : The Id of a state.</li> <li><tt>Abbreviation</tt> : The abbreviation of a state.</li> <li><tt>Description</tt> : The description of a state.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> <div id="donationservice"> <h2 id="donationservice-constructor">new DonationService(partId, options) <a href="#donationservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.DonationService provides methods needed for taking donations and retrieving confirmation information.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">partId</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">The Id of an Advanced Donation Form part that will be used as a context for all method calls.</td> </tr> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-completebbspdonation">completeBBSPDonation(id, successCallback, failureCallback) <a href="#donationservice-completebbspdonation"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Signals the application to confirm that the credit card donation has been paid in Blackbaud secured payment and to complete the creation of the donation. Updates the donation status and sends the acknowledgment email.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">id</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The GUID id of the donation that should be completed.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object describing the donation with the specified Id after its status has been updated.</td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-getrecurringgiftinstallmentamount">getRecurringGiftInstallmentAmount(totalGiftAmount, numberOfInstallments) <a href="#donationservice-getrecurringgiftinstallmentamount"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>This calculates the price of each installment for a recurring gift based on the number of installments the website user wants to make.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">totalGiftAmount</td> <td class="type"> <span class="param-type">Decimal</span> </td> <td class="description last">The total amount to be donated.</td> </tr> <tr> <td class="name">numberOfInstallments</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">The total number of installments.</td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-getrecurringgiftlastpaymentdate">getRecurringGiftLastPaymentDate(numberOfInstallments, frequencyCode, installmentStartDate, installmentMonth, installmentDayOfMonth) <a href="#donationservice-getrecurringgiftlastpaymentdate"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>This calculates the end date of a recurring installment based on the number of installments the website user wants to make.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">numberOfInstallments</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">The total number of installments</td> </tr> <tr> <td class="name">frequencyCode</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">Frequency code.</td> </tr> <tr> <td class="name">installmentStartDate</td> <td class="type"> <span class="param-type">date</span> </td> <td class="description last">Date on which website user wants to start the installment.</td> </tr> <tr> <td class="name">installmentMonth</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">Installment month.</td> </tr> <tr> <td class="name">installmentDayofMonth</td> <td class="type"> <span class="param-type">Integer</span> </td> <td class="description last">Day of the Month.</td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-createdonation">createDonation(donation, successCallback, failureCallback) <a href="#donationservice-createdonation"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Validates the specified donation parameter. If valid, creates a donation transaction and saves it to the database. Stores the Id of the new donation in session so the user has permissions for the donation transaction. If the payment type is credit card, communicates with Blackbaud secured payment to set up a check out URI and adds that URI to the return object. For credit card payment, the donation is saved in a Pending state. For payments not using a credit card, the donation is saved in a Completed state and an acknowledgement email is sent. For credit card payments, the page is redirected to the Blackbaud secured payment checkout page after calling the successCallback function.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">donation</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object describing the donation transaction to be created.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object describing the donation that was created.</td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-getdonation">getDonation(id, successCallback, failureCallback) <a href="#donationservice-getdonation"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Ensures the user has access to this donation by finding the Id in their session. If so, returns information about the donation</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">id</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The GUID id of the donation whose information should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object describing the donation with the specified Id.</td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="donationservice-getdonationconfirmationhtml">getDonationConfirmationHtml(id, successCallback, failureCallback) <a href="#donationservice-getdonationconfirmationhtml"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Gets HTML for a confirmation screen for the completed donation. Ensures the user has access to this donation by finding the Id in their session. If so, loads the donation and merges the fields into the partâs confirmation block</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">id</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The GUID id of the donation that should be completed.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed a string containing the confirmation HTML from the part with details from the specified donation merged in.</td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> <div id="imageservice"> <h2 id="imageservice-constructor">new ImageService(options) <a href="#imageservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.ImageService provides methods for getting information about images in the image gallery</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="imageservice-getimagesbyfolder">getImagesByFolder(folderPath, successCallback, failureCallback) <a href="#imageservice-getimagesbyfolder"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns a list of images in the specified folder. Only approved images that the user has rights to view will be returned.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">folderPath</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The path of an image folder whose images should be returned. Example: Folder1/SubFolder1/SubFolder2</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Url</tt> : The Url of the image.</li> <li><tt>Caption</tt> : The caption of the image.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="imageservice-getimagesbyfolderguid">getImagesByFolderGUID(folderGUID, successCallback, failureCallback) <a href="#imageservice-getimagesbyfolderguid"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns a list of images in the specified folder. Only approved images that the user has rights to view will be returned.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">folderGUID</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The GUID of an image folder whose images should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Url</tt> : The Url of the image.</li> <li><tt>Caption</tt> : The caption of the image.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> <h2 id="imageservice-getimagesbytag">getImagesByTag(tag, successCallback, failureCallback) <a href="#imageservice-getimagesbytag"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns a list of images with the specified tag. Only approved images that the user has rights to view will be returned.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">tag</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The tag whose images should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an array of objects with the following properties: <ul> <li><tt>Url</tt> : The Url of the image.</li> <li><tt>Caption</tt> : The caption of the image.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> <div id="queryservice"> <h2 id="queryservice-constructor">new QueryService(options) <a href="#queryservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.QueryService provides methods for retrieving query execution results from the CRM using calls to the BBIS REST services.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="queryservice-getresults">getResults(queryId, successCallback, failureCallback, filters) <a href="#queryservice-getresults"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns the result of executing the specified, published query. The query is executed as the last user to save the query. The results are cached and may be up to 10 minutes old. The results are limited to 5000 rows.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">queryId</td> <td class="type"> <span class="param-type">String</span> </td> <td class="description last">The Id of a query whose results should be returned.</td> </tr> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object with the following properties: <ul> <li><tt>Fields</tt> : An array of objects describing the fields returned from the query. The objects have have the following properties: <ul> <li><tt>Name</tt> : The name of the column in the query.</li> <li><tt>Caption</tt> : The caption of the column defined in the query.</li> </ul> </li> <li><tt>Rows</tt> : An array of objects describing the rows returned from the query. The objects have have the following properties: <ul> <li><tt>Values</tt> : An array of the values returned for the row. The values are in the same order as the array of fields.</li> </ul> </li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> <tr> <td class="name">filters</td> <td class="type"> <span class="param-type">Array</span> </td> <td class="description last">An array of the filters to filter the results to rows that contain the specified value in the specified column. When specifying a column, use the name that is found in the query response. Depending on the type of column being filtered, the results may filter to rows that exactly match the specified value instead of those that contain the specified value. Summary columns such as MAX, MIN, and COUNT cannot be used as filters and will be ignored. The array should contain objects with the following properties: <ul> <li><tt>columnName</tt> : The name of the column that should be used to filter the results.</li> <li><tt>value</tt> : The value that the specified column should be filtered by.</li> </ul></td> </tr> </tbody> </table></dd> </dl> </div> <div id="userservice"> <h2 id="userservice-constructor">new UserService(options) <a href="#userservice-constructor"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>BLACKBAUD.api.UserService provides methods for retrieving information about the currently logged in BBIS user from the CRM using calls to the BBIS REST services.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">options</td> <td class="type"> <span class="param-type">Object</span> </td> <td class="description last">An object literal containing one or more of the following optional properties: <ul> <li><tt>url</tt> : The URL of the BBIS site from which the data will be retrieved. This value is optional when accessed from a BBIS page. The default value will be the BBIS URL of the current page.</li> <li><tt>crossDomain</tt> : Indicates the BBIS url specified is from a separate domain than the current page. When True, the class will handle the complexities of making cross domain requests to retrieve data. The default value is False.</li> </ul></td> </tr> </tbody> </table></dd> </dl> <h2 id="userservice-getprofile">getProfile(successCallback, failureCallback) <a href="#userservice-getprofile"><i class="fa fa-link"></i></a></h2> <dl> <dt class="description">Description</dt> <dd>Returns profile information for the current user. If the user is not logged in, then it may be populated based on the current email-recipient information.</dd> <dt class="parameters">Parameters</dt> <dd><table class="table table-condensed table-parameters"> <thead> <tr> <th>Name</th> <th>Type</th> <th class="last">Description</th> </tr> </thead> <tbody> <tr> <td class="name">successCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request succeeds. The function will be passed an object with the following properties: <ul> <li><tt>Addresses</tt> : An array of objects describing the addresses of the current user. The objects have have the following properties: <ul> <li><tt>City</tt> : The address's city.</li> <li><tt>Country</tt> : The address's country.</li> <li><tt>Id</tt> : The Id of the address.</li> <li><tt>IsPrimary</tt> : Boolean indicating if the address is the user's primary address.</li> <li><tt>PostalCode</tt> : The address's postal code.</li> <li><tt>State</tt> : The address's state.</li> <li><tt>StreedAddress</tt> : The address's street address.</li> <li><tt>Type</tt> : The Id of the type of the address.</li> </ul> </li> <li><tt>EmailAddresses</tt> : An array of objects describing the email addresses of the current user. The objects have have the following properties: <ul> <li><tt>EmailAddress</tt> : The email address.</li> <li><tt>Id</tt> : The Id of the email address.</li> <li><tt>IsPrimary</tt> : Boolean indicating if the email address is the user's primary email address.</li> <li><tt>Type</tt> : The Id of the type of the email address.</li> </ul> </li> <li><tt>FirstName</tt> : The first name of the current user.</li> <li><tt>LastName</tt> : The last name of the current user.</li> <li><tt>Phone</tt> : The phone number of the current user.</li> <li><tt>Title</tt> : The title of the current user.</li> </ul></td> </tr> <tr> <td class="name">failureCallback</td> <td class="type"> <span class="param-type">function</span> </td> <td class="description last">The function to call if the request fails.</td> </tr> </tbody> </table></dd> </dl> </div> </div> <!-- .col-md-9 --> </div> <!-- .row --> </div> <!-- .container --> </div> <!-- .content --> <div class="footer"> <div class="container"> <div class="row"> <div class="col-xs-6 col-sm-4"> <p> <a href="/bbis"> <img src="/bbis/assets/img/logo-lonely.png" alt="Blackbaud Internet Solutions" class="img-responsive" /> </a> </p> <ul class="list-unstyled"> <li> <a href="/bbis/start/">Getting Started</a> </li> <li> <a href="/bbis/guide/">Developer Guide</a> </li> <li> <a href="/bbis/reference/">Technical Reference</a> </li> <li> <a href="/bbis/code/">Code Samples</a> </li> <li> <a href="/bbis/help/">Help</a> </li> </ul> <!-- .list-unstyled --> </div> <!-- .col-sm-4 --> <div class="col-xs-6 col-sm-4"> <p> <a href="http://www.bbdevnetwork.com" target="_blank"> <img src="/bbis/assets/img/logo-developer-small.png" alt="Blackbaud Developer Network" class="img-responsive" /> </a> </p> <ul class="list-unstyled"> <li> <a href="https://www.blackbaud.com/nonprofit-resources/sdk-resources.aspx" target="_blank"> Blackbaud Infinity SDK </a> </li> <li> <a href="http://open.convio.com/" target="_blank"> Blackbaud Luminate </a> </li> <li> <a href="https://www.blackbaud.com/files/support/netcommunity-developer/netcommunity-developer.htm" target="_blank"> Blackbaud NetCommunity </a> </li> <li> <a href="https://www.blackbaud.com/files/support/guides/re7ent/api.pdf" target="_blank"> Blackbaud Raiser's Edge </a> </li> <li> <a href="http://developer.everydayhero.com" target="_blank"> Everyday Hero </a> </li> </ul> <!-- .list-unstyled --> </div> <!-- .col-sm-4 --> <div class="col-sm-4"> <div class="row"> <div class="col-sm-12"> <ul class="list-inline bb-love"> <li> <a href="http://www.blackbaud.com" target="_blank"> <img src="/bbis/assets/img/logo-bb-white.png" alt="Blackbaud" class="img-responsive" /> </a> </li> <li> <i class="fa fa-lg fa-plus"></i> </li> <li> <a href="http://www.github.com/blackbaud-community" target="_blank"> <img src="/bbis/assets/img/logo-github.png" alt="GitHub" class="img-responsive" /> </a> </li> </ul> <!-- .list-inline --> </div> <!-- .col-sm-12 --> </div> <!-- .row --> <div class="row"> <div class="col-sm-12"> <ul class="list-inline social-icons"> <li> <a href="https://github.com/blackbaud-community" target="_blank"> <i class="fa fa-github"></i> </a> </li> <li> <a href="https://plus.google.com/113382459921828617974" target="_blank"> <i class="fa fa-google-plus"></i> </a> </li> <li> <a href="http://twitter.com/blackbaud" target="_blank"> <i class="fa fa-twitter"></i> </a> </li> <li> <a href="https://www.facebook.com/blackbaud" target="_blank"> <i class="fa fa-facebook"></i> </a> </li> <li> <a href="http://www.youtube.com/user/blackbaudinc" target="_blank"> <i class="fa fa-youtube"></i> </a> </li> </ul> <!-- .list-inline --> </div> <!-- .col-sm-12 --> </div> <!-- .row --> </div> <!-- .col-sm-4 --> </div> <!-- .row --> </div> <!-- .container --> </div> <!-- .footer --> <div class="copyright"> <div class="container"> <div class="row"> <div class="col-sm-6"> <p>&copy; 2014 Blackbaud, Inc. All rights reserved.</p> </div> <div class="col-sm-6"> <p class="feedback-link"> <a href="/bbis/help/">Provide Feedback</a> </p> </div> </div> </div> </div> <!-- .copyright --> <div id="omnibar"> &nbsp; </div> <script src="//code.jquery.com/jquery-1.11.1.min.js"></script> <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script> <script src="/bbis/assets/js/combine.site.js?v=2018-11-01-18:16:41"></script> </body> </html>