<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Blackbaud Internet Solutions | Developer Guide | Custom Handlers</title> <link rel="icon" href="/bbis/assets/img/favicon.ico" type="image/ico"> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"> <link rel="stylesheet" href="/bbis/assets/css/combine.site.css?v=2018-11-01-18:16:41"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-2418840-40', 'auto'); ga('send', 'pageview'); </script> </head> <body class="layout-compress section-guide subsection-custom-handlers"> <nav class="navbar" role="navigation" id="top"> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bb-navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a href="/bbis/" class="navbar-brand"> <img src="/bbis/assets/img/logo-bbis.png" alt="Blackbaud Internet Solutions" class="img-responsive" /> </a> </div> <!-- navbar-header --> <div class="collapse navbar-collapse" id="bb-navbar"> <ul class="nav navbar-nav navbar-right"> <li > <a href="/bbis/start/"> Getting Started </a> </li> <li class="active"> <a href="/bbis/guide/"> Developer Guide </a> </li> <li > <a href="/bbis/reference/"> Technical Reference </a> </li> <li class=""> <a href="/bbis/code/"> Code Samples </a> </li> <li > <a href="/bbis/help/"> <i class="fa fa-fw fa-question-circle hidden-xs"></i> <span class="visible-xs-inline">Help</span> </a> </li> </ul> </div> <!-- .navbar-collapse --> </div> <!-- .container --> </nav> <!-- .navbar.navbar-inverse --> <div class="content"> <div class="container"> <div class="row"> <div class="col-md-3 hidden-xs hidden-sm"> <div class="sidebar"> <ul class="nav nav-pills nav-stacked nav-sidebar"> <!-- Ridiculous Bootstrap Scrollspy bug that required this nested linkage to function properly --> <li class="hidden"> <a href="#top">Top</a> <ul class="nav"> <li> <a href="#top">Top</a> </li> </ul> </li> <li class="back-to back-to-section"> <a href="/bbis/guide/"> Developer Guide </a> </li> <li class=""> <a href="/bbis/guide/advanced-donation-form/">Advanced Donation Form</a> </li> <li class=""> <a href="/bbis/guide/blackbaud-secure-payments/">Blackbaud Secure Payments</a> </li> <li class=""> <a href="/bbis/guide/custom-content-parts/">Custom Content Parts</a> </li> <li class=""> <a href="/bbis/guide/custom-framework-parts/">Custom Framework Parts</a> </li> <li class=" active scrollspy-start "> <a href="/bbis/guide/custom-handlers/">Custom Handlers</a> <ul class="nav"> <li> <a href="#overview">Custom Handlers Overview</a> </li> <li> <a href="#write">Write a Custom Handler</a> </li> <li> <a href="#call">Call a Custom Handler</a> </li> </ul> </li> <li class=""> <a href="/bbis/guide/user-imports/">User Imports</a> </li> <li class=""> <a href="/bbis/guide/responsive-design/">Responsive Design</a> </li> <li class="back-to back-to-top"> <a href="#top" class=""> <i class="fa fa-caret-square-o-up"></i> </a> </li> </ul> </div> </div> <!-- .col-md-3 --> <div class="col-md-9 readability"> <h2 id="overview">Custom Handlers</h2> <p>Custom handlers are custom Blackbaud Internet Solutions components that allow you to manage the REST (Representational State Transfer) model of web requests and responses for your website. The REST model defines the underlying concept that just by specifying a URL, you can get a response that is appropriate for a task.</p> <p>You store custom handlers as classes on your web server, and they receive unique URLs but are not associated with web pages or web services. With custom handlers, you can write REST-based custom code to handle custom requests and responses for your website. These custom handlers can access data from your Blackbaud CRM back office as well as data from your website. This allows you to make data requests from other programs and to return data in response to data requests</p> <h2 id="write">Write a Custom Handler</h2> <p>To create a custom handler, you write a class that inherits from BBNCExtensions.CustomHandlers.CustomHandler. You need to override the ProcessRequest sub that receives the ASP.NET HttpContext for the request. The context contains the Request and Response objects.</p> <p>You use the Request object to inspect the request, looking for query string parameters or posted form fields that your handler may expect. You use the Response object to write out a response.</p> <p>Just like custom parts, custom handlers have an API property to access the things exposed in the API. This allows handlers to access RSS feeds, documents, part data, and much more.</p> <p>Since you have a reference to BBNCExtensions, you can call Custom Web Methods that you can write for the RE7Service, where you have access to Blackbaud Internet Solutions.</p> <h2 id="call">Call a Custom Handler</h2> <p>You compile your project and deploy it to the \NetCommunity\bin folder of your installation directory. The URL for the custom handler uses the following format: <code>http://{your site}/components/custom.ashx?handler={your assemblyName.typeName}</code> To pass parameters to the handler, place them at the end of the URL: <code>http://{your site}/components/custom.ashx?handler={your assemblyName.typeName}&foo=bar</code></p> <p>The handler code can inspect the Context.Request.QueryString ("foo") item to get the value (“bar”). Consumers of your handler can also post form elements to your handler, in which case you look to Context.Request.Form ("foo") for that value.</p> <p>You can also create a part to supply the response to your the custom handler. For example, you can create a custom part with a text box on the part editor to allow you to edit the content for the response. You can use the API to get the content from the custom part because all custom handlers have access to the API. Here is a simple example:</p> <div class="highlight-wrapper"> <div class="copy-code" title="Copy to Clipboard" data-trigger="manual" data-placement="left" data-container="body"> <i class="fa fa-files-o"></i> </div> <div class="highlight"><pre><code class="language-vbnet" data-lang="vbnet">'locate the FBML part that holds the fbml to return
Dim oPart As FBMLContent

oPart = Me.API.Parts.LoadCustomContentFromPartId(_
  CInt(context.Request.QueryString("partid")), GetType(FBMLContent))
 
If oPart IsNot Nothing Then
  sResponse = oPart.FBML</code></pre></div> </div> <p>In the sample code, an FBML custom part stores an FBMLContent object as its content. The handler supports a Query String parameter called partId to identify the particular instance of the custom FBML part get. So if the part ID is 616, the URL to call the handler would be: <code>http://blackbaud.org/netcommunity/components/custom.ashx?handler=facebooksample.getfbml&partid=616</code>.</p> </div> <!-- .col-md-9 --> </div> <!-- .row --> </div> <!-- .container --> </div> <!-- .content --> <div class="footer"> <div class="container"> <div class="row"> <div class="col-xs-6 col-sm-4"> <p> <a href="/bbis"> <img src="/bbis/assets/img/logo-lonely.png" alt="Blackbaud Internet Solutions" class="img-responsive" /> </a> </p> <ul class="list-unstyled"> <li> <a href="/bbis/start/">Getting Started</a> </li> <li> <a href="/bbis/guide/">Developer Guide</a> </li> <li> <a href="/bbis/reference/">Technical Reference</a> </li> <li> <a href="/bbis/code/">Code Samples</a> </li> <li> <a href="/bbis/help/">Help</a> </li> </ul> <!-- .list-unstyled --> </div> <!-- .col-sm-4 --> <div class="col-xs-6 col-sm-4"> <p> <a href="http://www.bbdevnetwork.com" target="_blank"> <img src="/bbis/assets/img/logo-developer-small.png" alt="Blackbaud Developer Network" class="img-responsive" /> </a> </p> <ul class="list-unstyled"> <li> <a href="https://www.blackbaud.com/nonprofit-resources/sdk-resources.aspx" target="_blank"> Blackbaud Infinity SDK </a> </li> <li> <a href="http://open.convio.com/" target="_blank"> Blackbaud Luminate </a> </li> <li> <a href="https://www.blackbaud.com/files/support/netcommunity-developer/netcommunity-developer.htm" target="_blank"> Blackbaud NetCommunity </a> </li> <li> <a href="https://www.blackbaud.com/files/support/guides/re7ent/api.pdf" target="_blank"> Blackbaud Raiser's Edge </a> </li> <li> <a href="http://developer.everydayhero.com" target="_blank"> Everyday Hero </a> </li> </ul> <!-- .list-unstyled --> </div> <!-- .col-sm-4 --> <div class="col-sm-4"> <div class="row"> <div class="col-sm-12"> <ul class="list-inline bb-love"> <li> <a href="http://www.blackbaud.com" target="_blank"> <img src="/bbis/assets/img/logo-bb-white.png" alt="Blackbaud" class="img-responsive" /> </a> </li> <li> <i class="fa fa-lg fa-plus"></i> </li> <li> <a href="http://www.github.com/blackbaud-community" target="_blank"> <img src="/bbis/assets/img/logo-github.png" alt="GitHub" class="img-responsive" /> </a> </li> </ul> <!-- .list-inline --> </div> <!-- .col-sm-12 --> </div> <!-- .row --> <div class="row"> <div class="col-sm-12"> <ul class="list-inline social-icons"> <li> <a href="https://github.com/blackbaud-community" target="_blank"> <i class="fa fa-github"></i> </a> </li> <li> <a href="https://plus.google.com/113382459921828617974" target="_blank"> <i class="fa fa-google-plus"></i> </a> </li> <li> <a href="http://twitter.com/blackbaud" target="_blank"> <i class="fa fa-twitter"></i> </a> </li> <li> <a href="https://www.facebook.com/blackbaud" target="_blank"> <i class="fa fa-facebook"></i> </a> </li> <li> <a href="http://www.youtube.com/user/blackbaudinc" target="_blank"> <i class="fa fa-youtube"></i> </a> </li> </ul> <!-- .list-inline --> </div> <!-- .col-sm-12 --> </div> <!-- .row --> </div> <!-- .col-sm-4 --> </div> <!-- .row --> </div> <!-- .container --> </div> <!-- .footer --> <div class="copyright"> <div class="container"> <div class="row"> <div class="col-sm-6"> <p>&copy; 2014 Blackbaud, Inc. All rights reserved.</p> </div> <div class="col-sm-6"> <p class="feedback-link"> <a href="/bbis/help/">Provide Feedback</a> </p> </div> </div> </div> </div> <!-- .copyright --> <div id="omnibar"> &nbsp; </div> <script src="//code.jquery.com/jquery-1.11.1.min.js"></script> <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script> <script src="/bbis/assets/js/combine.site.js?v=2018-11-01-18:16:41"></script> </body> </html>